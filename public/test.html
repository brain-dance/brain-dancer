<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Testing video stuff</title>
    <link
      href="https://vjs.zencdn.net/7.6.0/video-js.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/videojs-record/3.8.0/css/videojs.record.min.css"
      rel="stylesheet"
    />

    <script src="https://vjs.zencdn.net/7.6.0/video.min.js"></script>
    <script src="https://unpkg.com/recordrtc/RecordRTC.js"></script>
    <script src="https://unpkg.com/webrtc-adapter/out/adapter.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-record/3.8.0/videojs.record.min.js"></script>
    <script defer src="../brain/posenet.js"></script>
  </head>
  <body>
    <video id="video" playsinline class="video-js vjs-default-skin">
      <p class="vjs-no-js">
        To view this video please enable JavaScript, or consider upgrading to a
        web browser that
        <a href="https://videojs.com/html5-video-support/" target="_blank">
          supports HTML5 video.
        </a>
      </p>
    </video>
    <!-- <canvas
      id="output"
      style="position: absolute; top: 0; left: 0; z-index: 1; width: 720px;
      height: 480px; margin: 8px;"
    ></canvas> -->

    <script>
      var options = {
        controls: true,
        width: 720,
        height: 480,
        fluid: false,
        controlBar: {
          volumePanel: false
        },
        plugins: {
          record: {
            audio: true,
            video: true,
            maxLength: 30,
            debug: true
          }
        }
      };

      // apply some workarounds for certain browsers
      // applyVideoWorkaround();

      var player = videojs('video', options, function() {
        // print version information at startup
        var msg =
          'Using video.js ' +
          videojs.VERSION +
          ' with videojs-record ' +
          videojs.getPluginVersion('record') +
          ' and recordrtc ' +
          RecordRTC.version;
        videojs.log(msg);
      });

      // error handling
      player.on('deviceError', function() {
        console.warn('device error:', player.deviceErrorCode);
      });

      player.on('error', function(element, error) {
        console.error(error);
      });

      // user clicked the record button and started recording
      player.on('startRecord', function() {
        console.log('started recording!');
      });

      // user completed recording and stream is available
      player.on('finishRecord', function() {
        // the blob object contains the recorded data that
        // can be downloaded by the user, stored on server etc.
        console.log('finished recording: ', player.recordedData);
      });
    </script>
  </body>
</html>
